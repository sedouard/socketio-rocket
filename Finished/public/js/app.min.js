var socket=io.connect(),app=app||{};$(function(){function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexString="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexString),found=regex.exec(window.location.search);return null==found?"":decodeURIComponent(found[1].replace(/\+/g," "))}var $blastField=$("#blast"),$allPostsTextArea=$("#allPosts"),$clearAllPosts=$("#clearAllPosts"),$sendBlastButton=$("#send");socket.on("blast",function(data){var copy=$allPostsTextArea.html();$allPostsTextArea.html("<p>"+copy+data.msg+"</p>"),$allPostsTextArea.scrollTop($allPostsTextArea[0].scrollHeight-$allPostsTextArea.height()),g.refresh(data.count)}),socket.emit("register",{track:getParameterByName("track"),goal:getParameterByName("goal")}),$clearAllPosts.click(function(){$allPostsTextArea.text("")}),$sendBlastButton.click(function(){var blast=$blastField.val();blast.length&&socket.emit("blast",{msg:blast},function(){$blastField.val("")})}),$blastField.keydown(function(e){13==e.keyCode&&$sendBlastButton.trigger("click")})});